---
title: "Palmer Penguins"
author: "Tony Carilli"
date: '`r format(lubridate::today(), "%B %d, %Y")`'
output: 
  html_document:
    toc: yes
    toc_float: yes
    theme: journal
    highlight: espresso
    code_folding: hide
    df_print: paged
    fig_caption: true
---

```{r setup, message=FALSE}
# set various options and load necessary packages
knitr::opts_chunk$set(echo = TRUE, comment = NA, message = FALSE)
library(tidyverse)
library(palmerpenguins)
```

## R and RStudio

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

I produced this document with the RStudio IDE.  RStudio is an open source integrated development environment built for use with R. R is an open source language and environment for statistical computing and graphics.^[It is the most widely used dedicated statistical programming language according to [TIOBE](https://www.tiobe.com/tiobe-index/)]  Both R and RStudio are *free*.  

RStudio was built around the concept of reproducibility.  RStudio integrates code, analysis, and prose into one document.  

![RStudio Work Flow](images/r-rmarkdown-workflow-linear.png)

Students can seamlessly integrate there code, analysis, and prose into professional quality reproducible documents.  RStudio also integrates nicely with version control using Github, for example.

The same document can be used to produce multiple output formats.

![Output Formats](images/RMarkdownOutputFormats.png)

## An extended example{.tabset .tabset-fade .tabset-pills}

Let's look at the some data on penguins from the Palmer Station, Antarctica LTER.^[These data are available in the `palmerpenguin` package.  
Gorman KB, Williams TD, Fraser WR (2014) Ecological Sexual Dimorphism and
  Environmental Variability within a Community of Antarctic Penguins (Genus
  Pygoscelis). PLoS ONE 9(3): e90081.
  https://doi.org/10.1371/journal.pone.0090081] 
  
### The Data

The data contain observations for `r nrow(penguins)` penguins.^[Note: this numbers was generated by in-line code that counted these numbers from the data.  This avoids editing should future data have a different values.]  There are three different species in the data, collected from three different islands in the Palmer Archipelago, Antartica.  

The species of penguins are:

![Artwork by @allison_horst](images/lter_penguins.png)

The observations were collected on the Torgersen, Biscoe, and Dream islands. A searchable table of the data is available in the [Appendix]. 

The codebook for the dataset is as follows:

|Variable|Description|
|:--------|:-----------|
|`species`|species of penguin recorded as Adelie, Chinstrap, or Gentoo|
|`island`|island where observation was made recorded as Biscoe, Dream, or Torgeson|
|`bill_length_mm`|culmen length measured in millimeters|
|`bill_depth_mm`|culmen depth measured in millimeters|
|`flipper_length_mm`|flipper length measured in millimeters|
|`body_mass_g`|body mass measured in grams|
|`sex`|sex of bird recorded as male or female|

### Some Descriptive Statistics

The number of each type of penguin is

```{r count-species}
penguins %>% 
  count(species)
```

The number of penguins recorded on each island is

```{r count-island}
penguins %>% 
  count(island)
```

We can also look at penguins by island

```{r count-species-island}
penguins %>% 
  count(species, island)
```

Only Ad`r knitr::asis_output("\U00E9")`lie penguins were observed on more than one island.

Let's look at the means of each of the variables by species

```{r means}
penguins %>% 
  group_by(species) %>% 
  summarize(across(where(is.numeric), mean, na.rm = TRUE))
```

### Data visualizations

Compare flipper lengths by species

```{r histogram, warning=FALSE}
penguins %>% 
  ggplot(aes(x = flipper_length_mm)) + 
  geom_histogram(aes(fill = species), 
                 alpha = .5,
                 position = "identity") + 
  labs(x = "Flipper length (mm)",
       y = "Frequencey",
       title = "Penguin flipper lengths")
```

A boxplot body mass by species

```{r boxplot, warning=FALSE}
penguins %>% 
  ggplot(aes(x = species, y = body_mass_g, fill = island)) + 
  geom_boxplot() +
  labs(title = "Body Mass by Species across Islands",
       x = NULL,
       y = "Body mass (g)")
```


An example of the [Yule-Simpson Paradox](https://en.wikipedia.org/wiki/Simpson%27s_paradox)

```{r yule-1, warning=FALSE}
penguins %>% 
  ggplot(aes(x = bill_length_mm,
             y = bill_depth_mm)) + 
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "black") + 
  labs(title = "Yule-Simpson Paradox",
       x = "Culmen length (mm)",
       y = "Culmen depth (mm)") + 
  geom_point(aes(color = species)) + 
  geom_smooth(aes(color = species), method = "lm", se = FALSE)
```

The regression line in black indicates that there is an inverse relationship between culmen depth and culmen length. When we account for species the relationship is direct or positive.  


## Final thoughts

This was small example of the types of things that can be done with R and the RStudio IDE. While this has been rendered as an HTML document, it could have been rendered as PDF, Word document, slide show, etc.  

Finally, if you click the buttons that say code you can see the code used to generate the output.  

Thanks for reading. 


## Appendix

```{r data-table}
DT::datatable(penguins)
```


## Appendix 2

Bonus dynamic time series graph.

```{r dygraph}
AirPassengers %>% 
  dygraphs::dygraph()
```

## Appendix 3 - LaTex

*LaTex* code can be rendered in line like this: $\frac{dy}{dx}$ or as a block as shown below.

(@) The future value of a stream of payments:

$$\begin{align}
FV_n &= P_1(1+r_1)^1 + P_2(1+r_2)^2 + \cdots + P_n(1+r_n)^n \\
\\
&= \sum_{t=1}^{n} P_t(1+r_t)^t \\
\end{align}$$

(@) A **column vector**:

$$y_n = \begin{pmatrix} y_1 \\ y_2\\ y_3\\ \vdots \\y_n\end{pmatrix}$$

(@) A matrix

 $$A_{m,n} = \begin{pmatrix}  a_{1,1} & a_{1,2} & \cdots & a_{1,n} \\ a_{2,1} &  a_{2,2} & \cdots &  a_{2,n} \\   \vdots  & \vdots  & \ddots & \vdots  \\ a_{m,1} & a_{m,2} & \cdots & a_{m,n}  \end{pmatrix}$$